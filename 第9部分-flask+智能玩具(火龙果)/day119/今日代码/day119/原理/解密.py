# b'\x81\x83\xceH\xb6\x85\xffz\x85'

hashstr = b'\x81\xfe\x06y$m`\xbdt\x14\x14\xd5K\x03@\xd4WM.\xff\x04=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f=\x19\xc9L\x02\x0e\x9dM\x1e@\xf3f'
# b'\x81  \x8bn  \xf0\x89\xae\x06\x95\xe5\xc2\x01\xd0\xfe\xc1\x1c\x9c\xed'

# 将第二个字节也就是 \x8bn 第9-16位 进行与127进行位运算
payload = hashstr[1] & 127
print(payload)
if payload == 127:
    extend_payload_len = hashstr[2:10]
    mask = hashstr[10:14] # 钥匙
    decoded = hashstr[14:] # 数据
# 当位运算结果等于127时,则第3-10个字节为数据长度
# 第11-14字节为mask 解密所需字符串
# 则数据为第15字节至结尾
if payload == 126:
    extend_payload_len = hashstr[2:4]
    mask = hashstr[4:8]
    decoded = hashstr[8:]
# 当位运算结果等于126时,则第3-4个字节为数据长度
# 第5-8字节为mask 解密所需字符串
# 则数据为第9字节至结尾

# b'\x81\x8bn\xf0\x89\xae\x06\x95\xe5\xc2\x01\xd0\xfe\xc1\x1c\x9c\xed'
if payload <= 125:
    extend_payload_len = None
    mask = hashstr[2:6]  # \xf0\x89\xae\x06
    decoded = hashstr[6:]  # \x95\xe5\xc2\x01\xd0\xfe\xc1\x1c\x9c\xed

# 当位运算结果小于等于125时,则这个数字就是数据的长度
# 第3-6字节为mask 解密所需字符串
# 则数据为第7字节至结尾

str_byte = bytearray()#[b"",b"",b""]

for i in range(len(decoded)):
    byte = decoded[i] ^ mask[i % 4]
    str_byte.append(byte)

print(str_byte.decode("utf8"))


# \x95 ^ \xf0 h
# \xe5 ^ \x89 e